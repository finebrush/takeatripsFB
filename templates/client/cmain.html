{% extends 'client/cbase.html' %}
{% load static %}

  {% block headcontent %}
  <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
  <link rel="stylesheet" href="{% static 'css/bootstrap-theme.min.css' %}">
  <link rel="stylesheet" href="{% static 'css/fontAwesome.css' %}">
  <link rel="stylesheet" href="{% static 'css/hero-slider.css' %}">
  <link rel="stylesheet" href="{% static 'css/owl-carousel.css' %}">
  <link rel="stylesheet" href="{% static 'css/datepicker.css' %}">
  <link rel="stylesheet" href="{% static 'css/templatemo-style.css' %}">

  <link href="https://fonts.googleapis.com/css?family=Raleway:100,200,300,400,500,600,700,800,900" rel="stylesheet">

  <script src="{% static 'js/vendor/modernizr-2.8.3-respond-1.4.2.min.js' %}"></script>

  <link href='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.css' rel='stylesheet' />
  <script src='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.js'></script>

  <style>
    #openstreet-map {
      height: 100%;
      width:100%;
    }
	</style>

  {% endblock %}


  {% block content %}
    <div class="wrap">

      <!-- 상단 제목, 메뉴와 검색 -->
        <header id="header">
            <div class="container" style="height:100%;">
                <div class="row" style="height:100%;">
                    <div class="col-md-12">
                        <button id="primary-nav-button" type="button">Menu</button>
                        <div style="position:absolute; height:100%; padding: 14px 40px; font-size:16px; font-color:#1e1e1e;">Cheonggyecheon</div>
                        <div class="logo">
                            <img src="{% static 'imgs/client/icon02.png' %}" alt="menu">
                        </div>
                        <nav id="primary-nav" class="dropdown cf">
                            <ul class="dropdown menu">
                                <li class='active'><a href="#">Popular</a></li>
                                <li><a href="#">Most Visited</a></li>
                                <li><a class="scrollTo" data-scrollTo="blog" href="#">Blog Entries</a></li>
                                <li><a class="scrollTo" data-scrollTo="services" href="#">Our Services</a></li>
                                <li><a class="scrollTo" data-scrollTo="contact" href="#">Contact Us</a></li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>

            <!-- Tap menu / 컨텐츠는 아래 mTap 태그 안에.. -->
            <ul class="nav nav-pills nav-fill" style="background-color:#ffffff">
                <li class="nav-item">
                  <a class="nav-link active" id="tab1menu" style="height:50px;font-size:14px;padding-top:15px;border-radius:0;" role="tab" data-toggle="pill" href="#tab-1">ALL</a></li>
                <li class="nav-item">
                  <a class="nav-link" id="tab2menu" style="height:50px;font-size:14px;padding-top:15px;border-radius:0;" role="tab" data-toggle="pill" href="#tab-2">SEE</a></li>
                <li class="nav-item">
                  <a class="nav-link" id="tab3menu" style="height:50px;font-size:14px;padding-top:15px;border-radius:0;" role="tab" data-toggle="pill" href="#tab-3">EAT</a></li>
                <li class="nav-item">
                  <a class="nav-link" id="tab4menu" style="height:50px;font-size:14px;padding-top:15px;border-radius:0;" role="tab" data-toggle="pill" href="#tab-4">DRINK</a></li>
                <!--
                <li class="nav-item">
                  <a class="nav-link" style="height:50px;font-size:14px;padding-top:15px;border-radius:0;" role="tab" data-toggle="pill" href="#tab-5">자다</a></li>
                -->
            </ul>

            <div class="banner-caption" style="padding-top:8px;width:100%;height:35px;margin:0;text-align:-webkit-center;background-color:#465a75;">
                <span style="color:#ffffff;">TOUCH HERE TO DOWNLOAD OFFLINE MAP</span>
            </div>

        </header>

        <!-- Section 1 : Best Finder For You -->
        <section class="banner" id="top" style="position:fixed;z-index:888;top:131px;">
            <div class="container" style="height:100%;width:100%;margin:0;padding:0;">
                <div class="row" style="height:100%;width:100%;margin:0;padding:0;">
                    <div class="col-md-12" style="padding:0px;">

                        <div class="submit-form" style="height:100%;">
                          <!-- openstreet map goes here -->
                          <div id="openstreet-map"></div>
                        </div>

                    </div>
                </div>
            </div>
        </section>

        <!-- 드래그로 화면이 끌려올라갈때 뒷배경인 지도가 안보이게 가려주는 부분  -->
        <div class="tohidediv" style="position:fixed; bottom:-200px; z-index:900; background-color:#ffffff; width:100%; height:300px;">
        </div>

        <!-- 클릭하면 메인 모드로 갈 수 있는 레이어..  -->
        <div class="showdiv" style="text-align:center;padding:10px 0px;font-size:10px; position:fixed; bottom:0; width:100%; height:35px;background-color:#ffffff;z-index:888;">
          BACK TO LIST
        </div>


    </div>

    <!-- 클릭하면 지도맵 모드로 갈 수 있는 레이어..  -->
    <div class="hiddendiv" style="position:absolute;width:100%;height:70%;background-color:#ffe4c400;z-index:888;">
    </div>

    <!-- 서브 디테일 레이어
    <div class="subdetail" style="position:absolute;width:100%;height:100%;background-color:#ffffff; z-index:3600;">
    </div>
    -->

    <!-- Tap menu 컨텐츠 -->
    <div class="mtap" style="position:absolute; background-color:#ffffff; top:45%;z-index:999;">

        <div class="tab-content">
            <div class="tab-pane active" role="tabpanel" id="tab-1">
                {% include 'client/ctotal.html' %}
            </div>
            <div class="tab-pane" role="tabpanel" id="tab-2">
                {% include 'client/csee.html' %}
            </div>
            <div class="tab-pane" role="tabpanel" id="tab-3">
                {% include 'client/ceat.html' %}
            </div>
            <div class="tab-pane" role="tabpanel" id="tab-4">
                {% include 'client/cdrink.html' %}
            </div>
            <div class="tab-pane" role="tabpanel" id="tab-5">
                {% include 'client/csleep.html' %}
            </div>
        </div>


        <!-- Section 8 : Footer -->
        <footer>
            <div class="container">
                <div class="row">
                    <div class="col-md-5">
                        <div class="about-veno">
                            <div class="logo">
                                <img src="{% static 'imgs/client/logo.png' %}" style="width:150px;" alt="takeatrips Logo">
                            </div>
                            <p>Mauris sit amet quam congue, pulvinar urna et, congue diam. Suspendisse eu lorem massa. Integer sit amet posuere tellus, id efficitur leo. In hac habitasse platea dictumst.</p>
                            <ul class="social-icons">
                                <li>
                                    <a href="#"><i class="fa fa-facebook"></i></a>
                                    <a href="#"><i class="fa fa-twitter"></i></a>
                                    <a href="#"><i class="fa fa-linkedin"></i></a>
                                    <a href="#"><i class="fa fa-rss"></i></a>
                                    <a href="#"><i class="fa fa-dribbble"></i></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="contact-info">
                            <div class="footer-heading">
                                <h4>Contact Information</h4>
                            </div>
                            <p>Praesent iaculis gravida elementum. Proin fermentum neque facilisis semper pharetra. Sed vestibulum vehicula tincidunt.</p>
                            <ul>
                                <li><span>Phone:</span><a href="#">010-050-0550</a></li>
                                <li><span>Email:</span><a href="#">hi@company.co</a></li>
                                <li><span>Address:</span><a href="#">company.co</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </footer>


        <div class="sub-footer">
            <p>Copyright &copy; 2018 Company Name - Design:
              <a rel="nofollow" href="http://www.takeatrips.com">Take A trips</a>
            </p>
        </div>

        <!-- POIpoint DB 가져오기 테스트 -->
        <div style="position:absolute;">
            {% for poi in pois %}
            <h3>{{ forloop.counter }}) {{ poi.pname }}</h3>
            <p>{{ poi.point }} </p>
            <a class="likebutton" id="like{{poi.id}}" href="#" data-catid="{{ poi.id }}">Like</a>
            {% endfor %}
            <p id="message"><p>
        </div>

    </div>

    {% endblock %}

    {% block javascript %}
    <script src="{% static 'js/jquery-3.2.1.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>

    <script src="{% static 'js/datepicker.js' %}"></script>
    <script src="{% static 'js/plugins.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>

    <script>
      //Tap 메뉴 클릭할때 특정 레이어 위치 시키기
      $(document).on("click", ".nav-item", function () {
        //console.log($(document)[0].activeElement.id);
        var mTaps = document.getElementsByClassName("mtap");
        var mHide = document.getElementsByClassName("hiddendiv");
        var mToHide = document.getElementsByClassName("tohidediv");
        //console.log(mTaps); // 속성을 콘솔에서 찾아서 적용.

        mTaps[0].style.top = "45%" // 속성 변경
        $('html, body').animate({scrollTop : mTaps[0].style.top}, 400);

        mToHide[0].hidden = false; // false 가 보여지는거임.
        mHide[0].hidden = false;

        //Tap 메뉴에따라 배너 변경
        var expWord = $(document)[0].activeElement.id;
        //console.log(expWord);
        switch(expWord){
          case "tab2menu":
            $(".banner-caption")[0].style.backgroundColor = "#0b75cf";
            $(".banner-caption")[0].innerHTML = "<span style='color:#ffffff;'>FILTER BY : NEARBY</span>";
            break;
          case "tab3menu":
            $(".banner-caption")[0].style.backgroundColor = "#0b75cf";
            $(".banner-caption")[0].innerHTML = "<span style='color:#ffffff;'>FILTER BY : NEARBY</span>";
            break;
          case "tab4menu":
            $(".banner-caption")[0].style.backgroundColor = "#0b75cf";
            $(".banner-caption")[0].innerHTML = "<span style='color:#ffffff;'>FILTER BY : NEARBY</span>";
            break;
          default:
            $(".banner-caption")[0].style.backgroundColor = "#465a75";
            $(".banner-caption")[0].innerHTML = "<span style='color:#ffffff;'>TOUCH HERE TO DOWNLOAD OFFLINE MAP</span>";
        }
      });

      //클릭하여 서브레이어 내리기.
      $(document).on("click", ".hiddendiv", function () {
        var mTaps = document.getElementsByClassName("mtap");
        var mHide = document.getElementsByClassName("hiddendiv");
        var mToHide = document.getElementsByClassName("tohidediv");

        mTaps[0].style.top = "150%" // 속성 변경
        $('html, body').animate({scrollTop : mTaps[0].style.top}, 400);

        mToHide[0].hidden = true;
        mHide[0].hidden = true;
      });

      //클릭하여 서브레이어 올리기.
      $(document).on("click", ".showdiv", function () {
        var mTaps = document.getElementsByClassName("mtap");
        var mHide = document.getElementsByClassName("hiddendiv");
        var mToHide = document.getElementsByClassName("tohidediv");

        mTaps[0].style.top = "60%" // 속성 변경
        //$('html, body').animate({scrollTop : mTaps[0].style.top}, 400);

        mToHide[0].hidden = false;
        mHide[0].hidden = false;
      });

      //SEE manu -> See All 클릭시..
      $(document).on("click", "#tab2all", function () {
        //탭 메뉴 변경
        $("#tab1menu").removeClass('active');
        $("#tab2menu").addClass('active');
        //서브 페이지 변경
        $("#tab-1").removeClass('active');
        $("#tab-2").addClass('active');
        //배너 변경
        $(".banner-caption")[0].style.backgroundColor = "#0b75cf";
        $(".banner-caption")[0].innerHTML = "<span style='color:#ffffff;'>FILTER BY : NEARBY</span>";
        //console.log($(".banner-caption"));
      });

      //EAT manu -> See All 클릭시..
      $(document).on("click", "#tab3all", function () {
        //탭 메뉴 변경
        $("#tab1menu").removeClass('active');
        $("#tab3menu").addClass('active');
        //서브 페이지 변경
        $("#tab-1").removeClass('active');
        $("#tab-3").addClass('active');
        //배너 변경
        $(".banner-caption")[0].style.backgroundColor = "#0b75cf";
        $(".banner-caption")[0].innerHTML = "<span style='color:#ffffff;'>FILTER BY : NEARBY</span>";
      });

      //DRINK manu -> See All 클릭시..
      $(document).on("click", "#tab4all", function () {
        //탭 메뉴 변경
        $("#tab1menu").removeClass('active');
        $("#tab4menu").addClass('active');
        //서브 페이지 변경
        $("#tab-1").removeClass('active');
        $("#tab-4").addClass('active');
        //배너 변경
        $(".banner-caption")[0].style.backgroundColor = "#0b75cf";
        $(".banner-caption")[0].innerHTML = "<span style='color:#ffffff;'>FILTER BY : NEARBY</span>";
      });

      // Map 가시화 및 POI 배치
      L.mapbox.accessToken = 'pk.eyJ1IjoiZmluZWJydXNoIiwiYSI6ImNqaTM4ZmhvZTFqZjYza253cnVydm54aHgifQ.AMGLiQ9Mq1jusW07UW5THQ';
      var map = L.mapbox.map('openstreet-map', 'mapbox.streets')
          .setView([37.57032, 126.97687], 15);

      L.marker([37.57032, 126.97687])
          .addTo(map);
      L.marker([37.57426,126.97876])
          .addTo(map);
      L.marker([37.57856, 126.97679])
          .addTo(map);
      L.marker([37.58023,126.97302])
          .addTo(map);
      L.marker([37.57856, 126.98029])
          .addTo(map);
      L.marker([37.57819,126.97325])
          .addTo(map);
      L.marker([37.57357, 126.97471])
          .addTo(map);
      L.marker([37.56865,126.97584])
          .addTo(map);
      L.marker([37.57550,126.97672])
          .addTo(map);
      L.marker([37.57718,126.97887])
          .addTo(map);

    // POIpoint DB 가져오기 테스트
      $('.likebutton').click(function(){
          var catid;
          catid = $(this).attr("data-catid");
          // console.log("ok!!");
          $.ajax(
          {
              type:"GET",
              url: "{% url 'clientend:likepoi' %}",
              data:{
                       poi_id: catid
              },
              error : function(){
                  alert('통신실패!!');
              },
              success: function( data )
              {
                  // $( '#like'+ catid ).remove();
                  // $( '#message' ).text(data);
                  console.log(data);
                  alert("ok!");

              }
           })
      });
    </script>

    {% endblock %}
